<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Matemáticas en Emacs - Mario Román</title>
    <meta charset="utf-8" />
    <meta name="author" content="Mario Román" />
    <meta name="description" content="Tomando apuntes de matemáticas en Emacs" />
    <meta name="keywords" content="Emacs" />
    <link rel="stylesheet" href="/media/css/main.css" type="text/css">
    <link rel="stylesheet" href="/media/css/prettify.css" type="text/css">
  </head>
  <body class="container">
    <div>
      <header class="masthead">
        <h1 class="masthead-title"><a href="/">Mario Román</a></h1>
        <p>M42 - mromang08@gmail.com</p>
        <ul>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/tags/">Tags</a></li>
          <li><a href="/about/">About</a></li>
          <li><a href="https://github.com/m42">GitHub</a></li>
          <li><a href="/rss.xml">RSS</a></li>
        </ul>
        <form method="get" id="searchform" action="//www.google.com/search">
          <input type="text" class="field" name="q" id="s" placeholder="Search">
          <input type="hidden" name="as_sitesearch" value="m42.github.io">
        </form>
      </header>
    </div>

<div>
<div class="post">
<h1>Matemáticas en Emacs</h1>

<div id="outline-container-org11c240e" class="outline-2">
<h2 id="org11c240e">Apuntes a ordenador</h2>
<div class="outline-text-2" id="text-org11c240e">
<p>
Tomar apuntes de matemáticas con el ordenador es una tarea difícil por la
notación (símbolos, letras en otros alfabetos, índices...)
y la velocidad necesaria. Además, 
los diagramas, dibujos, flechas o anotaciones no textuales que
tomamos parecen imposibles de transcribir fielmente a un fichero.
</p>

<p>
<b>Latex</b> permite notación matemática pero no facilita la velocidad (al fin y
al cabo, Latex estaría pensado para edición de libros, no para tomar apuntes).
<b>Markdown</b> simplifica mucho el poder escribir, pero pierde mucha 
potencia respecto a Latex. Así que mi solución es usar 
Emacs con <b>org-mode</b>.
</p>
</div>
</div>

<div id="outline-container-org2cad28a" class="outline-2">
<h2 id="org2cad28a">Ventajas de org-mode</h2>
<div class="outline-text-2" id="text-org2cad28a">
<p>
<b>org-mode</b> tiene internamente un lenguaje de marcado similar al de markdown, con
la ventaja para el usuario de Emacs de que está adaptado precisamente para 
Emacs. Permite escribir fórmulas en Latex y exportar luego a <code>.tex</code> y <code>.pdf</code>, 
controlando las opciones de Latex. 
</p>

<p>
Una fórmula en Latex puede escribirse directamente en <b>org-mode</b> incluyéndola
entre <code>\( ... \)</code>, si está dentro de una línea de texto (como en \(i \ast x = x\)); 
o entre <code>\[ ... \]</code>, cuando queremos que se muestre aparte del texto. Ejemplo:
</p>

<p>
\[ \sum_{n=0}^\infty \frac{1}{2^n} \]
</p>

<p>
Y cuando terminamos de escribirla podemos <a href="http://orgmode.org/worg/org-tutorials/org-latex-preview.html">previsualizarla</a> directamente con
<code>C-c C-x C-l</code>. Así vamos comprobando que hemos escrito las fórmulas 
correctamente a costa de acercarnos a un editor <a href="https://es.wikipedia.org/wiki/WYSIWYG">WYSIWYG</a>.
</p>
</div>
</div>

<div id="outline-container-org48e3cf9" class="outline-2">
<h2 id="org48e3cf9">Zoom</h2>
<div class="outline-text-2" id="text-org48e3cf9">
<p>
Un problema menor (y quizá sólo mío) al configurar todo esto fue que las fórmulas 
previsualizadas me parecían demasiado pequeñas. Aunque estén en proporción con el texto, cuesta
más leerlas; y cuando aumentamos el tamaño del texto con <code>C-x C-+</code>, las 
fórmulas no se amplían con él. Para conseguir que lo hagan hay que incluir otro
pequeño truco, mezcla de dos respuestas de <a href="http://emacs.stackexchange.com/questions/3387/how-to-enlarge-latex-fragments-in-org-mode-at-the-same-time-as-the-buffer-text">thisirs y Mark</a> en Stack Overflow:
</p>

<div class="org-src-container">
<pre class="src src-lisp">(defun update-org-latex-fragment-scale ()
  (let ((text-scale-factor
         (expt text-scale-mode-step text-scale-mode-amount)))
    (plist-put org-format-latex-options
               :scale (* 1.2 text-scale-factor)))
)
(add-hook
 'text-scale-mode-hook
 'update-org-latex-fragment-scale)
</pre>
</div>
</div>
</div>

<div id="outline-container-org25483dd" class="outline-2">
<h2 id="org25483dd">Aumentando la velocidad de escritura</h2>
<div class="outline-text-2" id="text-org25483dd">
<p>
Mi objetivo principal con todo esto era escribir matemáticas más rápidamente, así
que <a href="http://emacs.stackexchange.com/questions/26322/math-autocompletion-in-org-mode">pregunté sobre autocompletado</a> y concluí en usar <code>latex-math-mode</code>. Esto 
permite incluir comandos de Latex con atajos de teclado. En su configuración
original usa el caracter <code>`</code> para acceder a ellos, así que <code>`-a</code> escribe <code>\alpha</code>.
Yo he decidido cambiar el acento invertido, que ya cuesta dos pulsaciones en el
teclado en español, por la <code>ç</code>, que no la suelo usar. Además de los que incluye
el paquete por defecto, se pueden escribir atajos propios.
</p>

<p>
Por otro lado, empecé a usar <b>yasnippets</b> en Emacs. Son cómodos, fáciles de programar,
y me permiten simplificar tareas como escribir diagramas conmutativos o complejos
simpliciales en pocos pasos.
</p>
</div>
</div>

<div id="outline-container-orgb062804" class="outline-2">
<h2 id="orgb062804">Diagramas conmutativos</h2>
<div class="outline-text-2" id="text-orgb062804">
<p>
Ahora estoy escribiendo sobre álgebra homológica y teoría de categorías, así que
la mayoría de lo que escribo usa secuencias exactas y diagramas conmutativos.
</p>

<p>
Para las secuencias exactas, por ejemplo, tengo simplemente
una plantilla con <code>yasnippet</code>, que me deja 
incluirlas escribiendo <code>complex_</code> y pulsando <code>&lt;tab&gt;</code>:
</p>

<div class="org-src-container">
<pre class="src src-text"># -*- mode: snippet -*-
# name: complex
# key: complex_
#--
\[ $1 \overset{$6}\longrightarrow 
$2 \overset{$7}\longrightarrow 
$3 \overset{$8}\longrightarrow 
$4 \overset{$9}\longrightarrow 
$5 \]
</pre>
</div>

<p>
Para los diagramas conmutativos, la solución es un poco más compleja. El
paquete <b>tikz</b> de Latex es muy útil para escribirlos pero es demasiado recargado
en sintaxis,
así que existe <b>tikz-cd</b>, que simplifica su sintaxis para centrarla en diagramas
conmutativos. Para usarlo, hay que empezar por incluir en el archivo
de configuración <code>init.el</code> las siguientes líneas: 
</p>

<div class="org-src-container">
<pre class="src src-lisp">(add-to-list
 'org-latex-packages-alist '("" "tikz" t))
(eval-after-load "preview"
  '(add-to-list
    'preview-default-preamble
    "\\PreviewEnvironment{tikzpicture}"
    t))
</pre>
</div>

<p>
Y además, en mi caso, tuve que cambiar el programa con el que generaba las
imágenes. Por lo menos a mí, me parece funcionar sólo <b>imagemagick</b>:
</p>

<div class="org-src-container">
<pre class="src src-lisp">(setq org-latex-create-formula-image-program 'imagemagick)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbbcca2c" class="outline-2">
<h2 id="orgbbcca2c">Cabeceras en Latex</h2>
<div class="outline-text-2" id="text-orgbbcca2c">
<p>
Cuando necesitamos funcionalidad adicional que ofrece Latex en bibliotecas aparte,
como usar <code>tikz-cd</code>, podemos incluirlas en la cabecera del archivo org como:
</p>

<pre class="example">
#+latex_header: \usepackage{amsthm}
#+latex_header: \usepackage{amsmath}
#+latex_header: \usepackage{tikz-cd}
</pre>
</div>
</div>

<div id="outline-container-org920ea48" class="outline-2">
<h2 id="org920ea48">Ensanchar secciones</h2>
<div class="outline-text-2" id="text-org920ea48">
<p>
Para evitar tener que repetir varias veces la misma cabecera en varios archivos, podemos
usar un sólo archivo para escribir matemáticas y fraccionarlo en secciones temáticas.
Cuando necesitamos tratar una sección, podemos usar la funcionalidad de <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Narrowing.html">org</a> para tratar
sólo una sección.
</p>
</div>
</div>

</div>
</div>
    <div>
      <div class="post-meta">
        <span title="post date" class="post-info">2016-09-26</span>
        <span title="last modification date" class="post-info">2016-12-04</span>
        <span title="tags" class="post-info"><a href="/tags/emacs/">emacs</a>, <a href="/tags/math/">math</a></span>
        <span title="author" class="post-info">Mario Román</span>
      </div>
      <script src="//code.jquery.com/jquery-latest.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="/media/js/main.js"></script>
      <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.x (<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
          Copyright &copy; 2012 - <span id="footerYear"></span> <a href="mailto:mromang08 &lt;at&gt; gmail &lt;dot&gt; com">Mario Román</a>
          &nbsp;&nbsp;-&nbsp;&nbsp;
          Powered by <a href="https://github.com/kelvinh/org-page" target="_blank">org-page</a>
          <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
      </div>
    </div>

  </body>
</html>
